---
title: "Cogcom exam"
author: "Sigrid"
date: "12/12/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r packages}
pacman::p_load(tidyverse, MuMIn, pastecs, WRS2, purr, data.table, magrittr)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}

files <- list.files(path = "data",     #PUT THE NAME OF YOUR FOLDER WITH DATA in the quotes, it also might need '/' in the end, experiment with it :)
                    pattern = ".csv",  #everything that contains '.csv' in its name will be listed
                    full.names = T)    #makes it include directory path, so instead of 'logfile_1.csv' it will be 'data/logfile_1.csv')

#read all the files into a tibble (a fancy df)
#data1 <- lapply(files, read_csv) %>%  # apply read_csv() to every element in files list and send the resulting tibbles to the next line
  #bind_rows()  #bind rows from resulting tibbles together so you have one dataset with all of your data

data <- lapply(files, read_csv) %>% plyr::rbind.fill()

```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

```{r PETERS KODE DO NOT TOUCH}

df <- data.frame(participant = data$participant, køn = data$Køn, alder = data$Alder, computertimer = data$`Hvor mange timer computer/xbox/andet spiller De om ugen?`, køretimer = data$`Hvor mange timer om ugen kører De cirka?`, kørekort = data$`Har De kørekort? (ja/nej)`, condition = data$Condition, estimate = data$Estimate, date = data$date, ratespeed1 = data$ratespeed1.response, ratespeed1_rt = data$ratespeed1.rt, ændre_svar = data$key_resp_4.keys, ændre_svar_rt = data$key_resp_4.rt, ratespeed2 = data$ratespeed2.response, ratespeed2_rt = data$ratespeed2.rt, glasskår = data$key_resp_3.keys, glasskår_rt = data$key_resp_3.rt)

df$ratespeed2[is.na(df$ratespeed2)] = 0
df$ratespeed2_rt[is.na(df$ratespeed2_rt)] = 0

colnames = c("partipant", "køn", "alder", "computertimer", "køretimer", "kørekort", "condition", "estimate", "date", "ratespeed1", "ratespeed1_rt", "ændre_svar", "ændre_svar_rt", "ratespeed2", "ratespeed2_rt", "glasskår", "glasskår_rt")

#Make new dataframe
new_df = data.frame(matrix(ncol = ncol(df), nrow = length(levels(df$data.participant))))
colnames(new_df) = colnames

#Go through each participant separately
for (participant_id in levels(df$participant)) {
  #Make a temporary dataframe only with that participant
  temp_df = filter(df, participant == participant_id)
  
  #Make a new row to append to the new dataframe
  new_row = data.frame(matrix(nrow = 1, ncol = ncol(new_df)))
  colnames(new_row) = colnames
  
  #Go through each column in the dataframe
  for (column in 1:ncol(temp_df)) {
    #And also each row
    for (row in 1:nrow(temp_df)) {
      
      #If the data in that row and column is not NA
      if (is.na(temp_df[row,column]) == FALSE) {
        #Save it to the new row
        new_row[1,column] = as.character(temp_df[row,column])
      }
    }
  }
  #Append the new row to the new dataframe
  new_df = rbind(new_df, new_row)
  }

```

```{r cleaning part 1}

class(new_df$computertimer)
new_df$computertimer <- as.factor(new_df$computertimer)
class(new_df$computertimer)
levels(new_df$computertimer)

#alder (2 rettelser)
new_df[63, 3] = 15
new_df[98, 3] = 16

#computertimer (12 rettelser)
new_df[8, 4] = 7
new_df[26, 4] = 0
new_df[27, 4] = 0
new_df[33, 4] = 2
new_df[35, 4] = 6
new_df[42, 4] = 7
new_df[44, 4] = 0.5
new_df[48, 4] = 0
new_df[52, 4] = 5
new_df[63, 4] = 6
new_df[97, 4] = 1
new_df[114, 4] = 7

#køretimer (10 rettelser)
new_df[12,5] = 0 
new_df[27,5] = 0
new_df[29, 5] = 0.5
new_df[47,5] = 1.5
new_df[66, 5] = 0
new_df[68, 5] = 0
new_df[76,5] = 0
new_df[97,5] = 0
new_df[98, 5] = 0
new_df[117,5] = 6.5

#kørekort
new_df[102,6]="nej"

# to lower case kørekort
new_df$kørekort <- tolower(new_df$kørekort)

# fixing university professor's data
new_df[125, 5] = 8
new_df[125, 4] = 0

# removing person with no age and NA's (8 rækker)
new_df <- new_df[-c(13, 34, 60, 71, 83, 98, 104, 119), ]

#### FJERN JULEMOR

#creating a new column with row numbers
new_df$ID <- seq.int(nrow(new_df))

```


DATA FRAME LOOKS GOOD NOW

```{r cleaning part 2}

#creating a new column with rating speed

class(new_df$ratespeed1)
new_df$ratespeed1 <- as.numeric(new_df$ratespeed1)
new_df$ratespeed2 <- as.numeric(new_df$ratespeed2)

new_df$hastighed1 <- new_df$ratespeed1*25
new_df$hastighed2 <- new_df$ratespeed2*25


```

```{r counting conditions and estimate }

# Counting the participant in condition and estimate
table(df_age$condition)
table(df_age$estimate)

# separating into older than and younger than 20 years

a1_old <- table(new_df$condition == "A" & new_df$estimate == 1 & new_df$alder >= 20)
a2_old <- table(new_df$condition == "A" & new_df$estimate == 2 & new_df$alder >= 20)
b1_old <- table(new_df$condition == "B" & new_df$estimate == 1 & new_df$alder >= 20)
b2_old <- table(new_df$condition == "B" & new_df$estimate == 2 & new_df$alder >= 20)

a1_ung <- table(new_df$condition == "A" & new_df$estimate == 1 & new_df$alder < 20)
a2_ung <- table(new_df$condition == "A" & new_df$estimate == 2 & new_df$alder < 20)
b1_ung <- table(new_df$condition == "B" & new_df$estimate == 1 & new_df$alder < 20)
b2_ung <- table(new_df$condition == "B" & new_df$estimate == 2 & new_df$alder < 20)


#ungroup()
#df_age <- new_df %>% group_by(new_df$alder >=20 | new_df$alder < 20)
#remove(df_age)

```

